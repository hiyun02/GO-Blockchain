<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Blockchain Explorer</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .block { padding:10px; margin:10px 0; border:1px solid #ddd; }
        .title { font-weight:bold; }
        a { text-decoration:none; }
    </style>
</head>
<body>

<h1>ğŸ“¦ CP ì²´ì¸ ì „ì²´ì¡°íšŒ</h1>

<div id="status"></div>
<div id="peers"></div>

<hr>

<h2>ë¸”ë¡ ëª©ë¡</h2>
<div id="blocks"></div>

<hr>

<button onclick="location.href='/upload.html'">ğŸš€ ì±„êµ´ ì‹œì‘í•˜ê¸°</button>

<script>
    // -----------------------
    // ë…¸ë“œ ìƒíƒœ
    // -----------------------
    fetch('/status')
        .then(res => res.json())
        .then(d => {
            document.getElementById('status').innerHTML = `
      <h2>ë…¸ë“œ ìƒíƒœ</h2>
      <p>ì£¼ì†Œ: ${d.addr}</p>
      <p>ë†’ì´(height): ${d.height}</p>
      <p>ë¶€íŠ¸ë…¸ë“œ ì—¬ë¶€: ${d.is_boot}</p>
      <p>ë¶€íŠ¸ë…¸ë“œ ì£¼ì†Œ: ${d.bootAddr}</p>
      <p>ì‹œì‘ ì‹œê°„: ${d.started_at}</p>
    `;
        });

    // -----------------------
    // Peers ëª©ë¡
    // -----------------------
    fetch('/peers')
        .then(res => res.json())
        .then(list => {
            document.getElementById('peers').innerHTML =
                "<h2>Peers</h2>" +
                list.map(p => `<p>${p}</p>`).join("");
        });

    // -----------------------
    // ë¸”ë¡ ë¦¬ìŠ¤íŠ¸
    // -----------------------
    fetch('/blocks?offset=0&limit=100')
        .then(res => res.json())
        .then(d => {
            const html = d.items.map(b => `
      <div class="block">
        <div class="title">
          <a href="/detail.html?id=${b.Index}">
            Block #${b.Index}
          </a>
        </div>
        <p>Timestamp: ${b.Timestamp}</p>
        <p>Entries: ${b.Entries ? b.Entries.length : 0}</p>
        <p>Hash: ${b.BlockHash.slice(0,16)}...</p>
      </div>
    `).join("");

            document.getElementById('blocks').innerHTML = html;
        });
</script>

</body>
</html>
